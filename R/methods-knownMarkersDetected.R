#' Known Markers Detected
#'
#' @rdname knownMarkersDetected
#' @name knownMarkersDetected
#' @author Michael Steinbaugh
#'
#' @param x All markers [data.frame] generated by
#'   [Seurat::FindAllMarkers()].
#' @param y Known markers imported by [readKnownMarkers()].
#' @param show Show [kable].
#'
#' @return [tibble].
NULL



# Methods ====
#' @rdname knownMarkersDetected
#' @export
setMethod(
    "knownMarkersDetected",
    signature(object = "data.frame", known = "tbl_df"),
    function(object, known, show = TRUE) {
        markers <- .groupMarkers(object) %>%
            left_join(known, by = "symbol") %>%
            filter(!is.na(.data[["cellType"]]))
        if (isTRUE(show)) {
            kable(markers, caption = "Known markers detected") %>% show
        }
        markers
    })
